<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Welcome to Firebase Hosting</title>


    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.8.0/css/bulma.min.css">
    <link type="text/css" rel="stylesheet" href="https://cdn.firebase.com/libs/firebaseui/3.5.2/firebaseui.css"></link>

    <!-- update the version number as needed -->
    <script defer src="/__/firebase/7.9.1/firebase-app.js"></script>
    <!-- include only the Firebase features as you need -->
    <script defer src="/__/firebase/7.9.1/firebase-auth.js"></script>
    <script defer src="/__/firebase/7.9.1/firebase-database.js"></script>
    <script defer src="/__/firebase/7.9.1/firebase-messaging.js"></script>
    <script defer src="/__/firebase/7.9.1/firebase-storage.js"></script>
    <!-- initialize the SDK after all desired features are loaded -->
    <script defer src="/__/firebase/init.js"></script>
    <script defer src="https://cdn.firebase.com/libs/firebaseui/3.5.2/firebaseui.js"></script>

    <!-- Get a task, taking into account all restrictions, and render it -->
    <script defer src="./js/load_task.js"></script>

    <!-- Submit a task response -->
    <script defer src="./js/submit_task.js"></script>


    <style media="screen">
      body { background: #ECEFF1; color: rgba(0,0,0,0.87); font-family: Roboto, Helvetica, Arial, sans-serif; margin: 0; padding: 0; }
      #load { color: rgba(0,0,0,0.4); text-align: center; font-size: 13px; }
      #task { width: 100%; }
      #gold, #first, #second { width: 100%; }
      @media (max-width: 600px) {
        body, #message { margin-top: 0; background: white; box-shadow: none; }
        body { border-top: 16px solid #ffa100; }
      }
    </style>
  </head>
  <body>
      <section class="section">
          <div class="container">
              <div id="message">
                  <h2>Welcome, <span id="username"></span></h2>
              </div>
              <div id="description">
                  Below are two pairs of graphs.  select the pair that is most similar.  The left hand graph is the same for both rows.
              </div>
              <div class="task box">
                  <div class="columns">
                      <div class="column"><img class="goldgraph" id="gold"></img></div>
                      <div class="column"><img id="first"></img></div>
                  </div>
              </div>
              <div class="task box">
                  <div class="columns">
                      <div class="column"><img class="goldgraph" id="gold"></img></div>
                      <div class="column"><img id="second"></img></div>
                  </div>
              </div>
          </div>
      </section>
    <script>
     document.addEventListener('DOMContentLoaded', function() {
         // // ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥
         // // The Firebase SDK is initialized and available here!
         //
         // firebase.auth().onAuthStateChanged(user => { });
         // firebase.database().ref('/path/to/ref').on('value', snapshot => { });
         // firebase.messaging().requestPermission().then(() => { });
         // firebase.storage().ref('/path/to/ref').getDownloadURL().then(() => { });
         //
         // // ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥ðŸ”¥

         try {
             test_submit_fn();
             var storage = firebase.storage();
             var data_source = "https://raw.githubusercontent.com/mrmechko/trips-annotate/master/data/json/data.json";
             var xhr = new XMLHttpRequest();
             xhr.responseType = 'json';
             xhr.onload = function(event) {
                 var blob = xhr.response;
                 render_task(blob[0], document);
             };
             // Make this a query to get an incomplete task instead
             xhr.open('GET', data_source);
             xhr.send();

             firebase.auth().onAuthStateChanged(user => {
                 if(user) {
                     document.getElementById('username').innerHTML=`${user.displayName}`;
                 } else {
                     window.location = 'index.html';
                 }
             });
         } catch (e) {
             console.error(e);
         }
     });
    </script>
  </body>
</html>
